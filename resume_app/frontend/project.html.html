<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Resume Master</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.2rem;
        }
        .navbar {
            background: rgba(0, 0, 0, 0.8) !important;
            backdrop-filter: blur(10px);
        }
        .card {
            margin: 20px auto;
            max-width: 800px;
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        .job {
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            background: #f8f9fa;
            transition: transform 0.2s;
        }
        .job:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .btn-google {
            background: #db4437;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: bold;
            transition: background 0.3s;
        }
        .btn-google:hover {
            background: #c23321;
        }
        .spinner-border { display: none; }
        .hero-section {
            text-align: center;
            color: white;
            padding: 50px 0;
        }
        .hero-section h1 {
            font-size: 3rem;
            font-weight: bold;
        }
        .hero-section p {
            font-size: 1.2rem;
            margin-bottom: 30px;
        }
        .modal-content {
            border-radius: 15px;
            border: none;
        }
        .form-control {
            border-radius: 10px;
        }
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            border-radius: 10px;
            font-weight: bold;
        }
        .btn-primary:hover {
            background: linear-gradient(45deg, #5a6fd8, #6a4190);
        }
        .alert {
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="fas fa-rocket"></i> Smart Resume Master</a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3" id="welcomeMessage" style="display: none;"><i class="fas fa-user"></i> Welcome, <span id="username"></span>!</span>
                <button class="btn btn-outline-light me-2" id="loginBtn" data-bs-toggle="modal" data-bs-target="#loginModal"><i class="fas fa-sign-in-alt"></i> Login</button>
                <button class="btn btn-outline-light" id="registerBtn" data-bs-toggle="modal" data-bs-target="#registerModal"><i class="fas fa-user-plus"></i> Register</button>
                <a class="btn btn-outline-light" id="logoutBtn" style="display: none;" href="/logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
            </div>
        </div>
    </nav>

    <div class="hero-section">
        <div class="container">
            <h1><i class="fas fa-magic"></i> Revolutionize Your Job Search</h1>
            <p>Upload your resume, get AI-powered insights, and discover personalized job recommendations.</p>
        </div>
    </div>

    <div class="container mt-4">
        <div class="alert alert-info text-center" id="loginPrompt">
            <h4><i class="fas fa-lock"></i> Please log in to access the full features.</h4>
        </div>
        <ul class="list-unstyled text-center fs-3">
            <li><i class="fas fa-brain"></i> AI-powered resume analysis</li>
            <li><i class="fas fa-search"></i> Personalized job recommendations</li>
            <li><i class="fas fa-shield-alt"></i> Secure and easy to use</li>
        </ul>

        <div id="uploadSection" style="display: none;">
            <div class="card">
                <div class="card-body">
                    <h2 class="text-center"><i class="fas fa-upload"></i> Upload Your Resume</h2>
                    <form id="uploadForm" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label for="resume" class="form-label"><i class="fas fa-file-alt"></i> Select Resume (PDF or DOCX):</label>
                            <input type="file" class="form-control" id="resume" name="resume" accept=".pdf,.docx" required>
                        </div>
                        <div class="mb-3">
                            <label for="location" class="form-label"><i class="fas fa-map-marker-alt"></i> Location (e.g., us):</label>
                            <input type="text" class="form-control" id="location" name="location" value="us" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">
                            <span class="spinner-border spinner-border-sm" id="uploadSpinner" role="status"></span>
                            <i class="fas fa-search"></i> Upload and Get Recommendations
                        </button>
                    </form>
                </div>
            </div>

            <div id="results" class="card" style="display: none;">
                <div class="card-body">
                    <h3 class="text-center"><i class="fas fa-chart-line"></i> Extracted Information</h3>
                    <div id="info" class="mb-4"></div>
                    <h3 class="text-center"><i class="fas fa-briefcase"></i> Job Recommendations</h3>
                    <div id="jobs"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-sign-in-alt"></i> Login</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-3">
                        <button class="btn btn-google w-100" id="googleSignInBtn">
                            <i class="fab fa-google"></i> Sign in with Google
                        </button>
                        <hr>
                    </div>
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginUsername" class="form-label"><i class="fas fa-user"></i> Username:</label>
                            <input type="text" class="form-control" id="loginUsername" required>
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label"><i class="fas fa-lock"></i> Password:</label>
                            <input type="password" class="form-control" id="loginPassword" required>
                        </div>
                        <div class="mb-3 text-end">
                            <small><a href="#" id="forgotPasswordLink">Forgot Password?</a></small>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">
                            <span class="spinner-border spinner-border-sm" id="loginSpinner" role="status"></span>
                            Login
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-plus"></i> Register</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="registerForm">
                        <div class="mb-3">
                            <label for="regUsername" class="form-label"><i class="fas fa-user"></i> Username:</label>
                            <input type="text" class="form-control" id="regUsername" required>
                        </div>
                        <div class="mb-3">
                            <label for="regPassword" class="form-label"><i class="fas fa-lock"></i> Password:</label>
                            <input type="password" class="form-control" id="regPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">
                            <span class="spinner-border spinner-border-sm" id="regSpinner" role="status"></span>
                            Register
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script>
        // Simulate login state
        let isLoggedIn = false;
        let currentUsername = '';

        function updateUI() {
            if (isLoggedIn) {
                document.getElementById('loginPrompt').style.display = 'none';
                document.getElementById('uploadSection').style.display = 'block';
                document.getElementById('welcomeMessage').style.display = 'inline';
                document.getElementById('username').textContent = currentUsername;
                document.getElementById('loginBtn').style.display = 'none';
                document.getElementById('registerBtn').style.display = 'none';
                document.getElementById('logoutBtn').style.display = 'inline';
            } else {
                document.getElementById('loginPrompt').style.display = 'block';
                document.getElementById('uploadSection').style.display = 'none';
                document.getElementById('welcomeMessage').style.display = 'none';
                document.getElementById('loginBtn').style.display = 'inline';
                document.getElementById('registerBtn').style.display = 'inline';
                document.getElementById('logoutBtn').style.display = 'none';
            }
        }

        // Google Sign-In Initialization (only for login)
        function handleCredentialResponse(response) {
            // Decode the JWT token to get user info
            const responsePayload = JSON.parse(atob(response.credential.split('.')[1]));
            const username = responsePayload.name || responsePayload.email.split('@')[0];
            
            // Simulate login with Google
            isLoggedIn = true;
            currentUsername = username;
            updateUI();
            bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
            alert('Signed in with Google successfully!');
        }

        window.onload = function () {
            google.accounts.id.initialize({
                client_id: 'YOUR_GOOGLE_CLIENT_ID',  // Replace with your actual Google Client ID
                callback: handleCredentialResponse
            });
            google.accounts.id.renderButton(
                document.getElementById('googleSignInBtn'),
                { theme: 'outline', size: 'large', width: '100%' }
            );
        };

        // Login Form
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            const spinner = document.getElementById('loginSpinner');
            spinner.style.display = 'inline-block';

            setTimeout(() => {
                spinner.style.display = 'none';
                if (username && password) {
                    isLoggedIn = true;
                    currentUsername = username;
                    updateUI();
                    bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
                    alert('Login successful!');
                } else {
                    alert('Invalid credentials.');
                }
            }, 1000);
        });

        // Register Form
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('regUsername').value;
            const password = document.getElementById('regPassword').value;
            const spinner = document.getElementById('regSpinner');
            spinner.style.display = 'inline-block';

            setTimeout(() => {
                spinner.style.display = 'none';
                if (username && password) {
                    alert('Registration successful! Please log in.');
                    bootstrap.Modal.getInstance(document.getElementById('registerModal')).hide();
                } else {
                    alert('Registration failed.');
                }
            }, 1000);
        });

        // Logout
        document.getElementById('logoutBtn').addEventListener('click', function() {
            isLoggedIn = false;
            currentUsername = '';
            updateUI();
        });

        // Forgot Password
        document.getElementById('forgotPasswordLink').addEventListener('click', function(e) {
            e.preventDefault();
            alert('Forgot Password feature is not implemented yet. Please contact support.');
        });

        // Upload Form
        document.getElementById('uploadForm').addEventListener('submit', function(e) {
            e.preventDefault();
            if (!isLoggedIn) {
                alert('Please log in first.');
                return;
            }
            const formData = new FormData();
            const fileInput = document.getElementById('resume');
            const locationInput = document.getElementById('location');
            const spinner = document.getElementById('uploadSpinner');
            
            if (!fileInput.files[0]) {
                alert('Please select a file.');
                return;
            }
            
            formData.append('resume', fileInput.files[0]);
            formData.append('location', locationInput.value);
            spinner.style.display = 'inline-block';
            document.getElementById('results').style.display = 'none';
            
            // Send to backend
            fetch('http://localhost:5000/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                spinner.style.display = 'none';
                if (data.error) {
                    alert('Error: ' + data.error);
                    return;
                }

                const infoDiv = document.getElementById('info');
                infoDiv.innerHTML = `
                    <div class="row">
                        <div class="col-md-6"><p><strong><i class="fas fa-tools"></i> Skills:</strong> ${data.extracted_info.skills.join(', ') || 'None detected'}</p></div>
                        <div class="col-md-6"><p><strong><i class="fas fa-clock"></i> Experience:</strong> ${data.extracted_info.experience.join(', ') || 'None detected'}</p></div>
                        <div class="col-md-6"><p><strong><i class="fas fa-graduation-cap"></i> Education:</strong> ${data.extracted_info.education.map(e => e.join(' ')).join(', ') || 'None detected'}</p></div>
                        <div class="col-md-6"><p><strong><i class="fas fa-key"></i> Keywords:</strong> ${data.extracted_info.keywords.join(', ') || 'None detected'}</p></div>
                    </div>
                `;

                const jobsDiv = document.getElementById('jobs');
                jobsDiv.innerHTML = '';
                if (data.job_recommendations.length === 0) {
                    jobsDiv.innerHTML = '<p>No job recommendations found.</p>';
                } else {
                    data.job_recommendations.forEach(job => {
                        const jobDiv = document.createElement('div');
                        jobDiv.className = 'job';
                        jobDiv.innerHTML = `
                            <h4><i class="fas fa-briefcase"></i> ${job.title}</h4>
                            <p><strong><i class="fas fa-building"></i> Company:</strong> ${job.company || 'N/A'}</p>
                            <p><strong><i class="fas fa-map-marker-alt"></i> Location:</strong> ${job.location || 'N/A'}</p>
                            <p>${job.description}</p>
                            <a href="${job.url}" target="_blank" class="btn btn-primary btn-sm"><i class="fas fa-external-link-alt"></i> View Job</a>
                        `;
                        jobsDiv.appendChild(jobDiv);
                    });
                }

                document.getElementById('results').style.display = 'block';
            })
            .catch(error => {
                spinner.style.display = 'none';
                alert('Error uploading file: ' + error.message);
            });
        });

        updateUI();
    </script>

    <footer class="bg-dark text-white text-center py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5><i class="fas fa-info-circle"></i> About Us</h5>
                    <p>Smart Resume Master helps you revolutionize your job search with AI-powered insights and personalized recommendations.</p>
                </div>
                <div class="col-md-4">
                    <h5><i class="fas fa-envelope"></i> Contact</h5>
                    <p>Email: ayushpangaonkar1@gmail.com</p>
                    <p>Phone: 12233344445</p>
                </div>
                <div class="col-md-4">
                    <h5><i class="fas fa-link"></i> Links</h5>
                    <a href="#" class="text-white me-3"><i class="fab fa-facebook"></i> Facebook</a>
                    <a href="#" class="text-white me-3"><i class="fab fa-twitter"></i> Twitter</a>
                    <a href="#" class="text-white"><i class="fab fa-linkedin"></i> LinkedIn</a>
                </div>
            </div>
            <hr class="my-4">
            <p>&copy; 2023 Smart Resume Master. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
